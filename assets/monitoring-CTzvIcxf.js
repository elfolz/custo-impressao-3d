import{_ as y,c as a,b as s,w as i,r as u,o as p,d as g,g as L,a as t,t as l,h as m,n as v,p as x,f as w}from"./index-DjhvKLd0.js";const A={data(){return{loading:!1,connected:!1,printerAddress:localStorage.getItem("pinterAddress"),videoUrl:null,imgUrl:null,wsUrl:null,ws:null,hostname:"K1-27B2",printFileName:"/usr/data/printer_data/gcodes/poison__PLA_7h45m.gcode",printProgress:null,currentLayer:null,totalLayer:null,printStartTime:null,printJobTime:null,printLeftTime:null,nozzleTemp:null,bedTemp:null,boxTemp:null,usedMaterialLength:null,fanMain:!1,fanAuxiliary:!1,fanCase:!1,addressRules:[r=>/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}$/.test(r)||"IP inválido"]}},mounted(){this.printerAddress&&this.connect()},methods:{connect(){this.printerAddress&&(this.loading=!0,this.videoUrl=`http://${this.printerAddress}:8080/?action=stream`,this.imgUrl=`http://${this.printerAddress}/downloads/original/current_print_image.png`,this.wsUrl=`ws://${this.printerAddress}:9999`,this.ws=new WebSocket(this.wsUrl),this.ws.onopen=()=>{this.connected=!0,this.loading=!1},this.ws.onclose=()=>{this.connected=!1,this.loading=!1},this.ws.onmessage=r=>{if(!r.data)return;const e=JSON.parse(r.data);e.layer&&(this.currentLayer=e.layer),e.TotalLayer&&(this.totalLayer=e.TotalLayer),e.printStartTime&&(this.printStartTime=new Date(e.printStartTime*1e3)),e.printJobTime&&(this.printJobTime=e.printJobTime),e.printLeftTime&&(this.printLeftTime=e.printLeftTime),e.printProgress&&(this.printProgress=e.printProgress),e.nozzleTemp&&(this.nozzleTemp=parseFloat(e.nozzleTemp).toFixed(2)),e.bedTemp0&&(this.bedTemp=parseFloat(e.bedTemp0).toFixed(2)),e.boxTemp&&(this.boxTemp=parseFloat(e.boxTemp).toFixed(2)),e.usedMaterialLength&&(this.usedMaterialLength=e.usedMaterialLength),e.fan&&(this.fanMain=!!e.fan),e.fanAuxiliary&&(this.fanAuxiliary=!!e.fanAuxiliary),e.fanCase&&(this.fanCase=!!e.fanCase),location.href.includes("log=true")&&console.log(e)},this.ws.onerror=r=>{this.connected=!1,this.loading=!1,console.log(r)})},saveAddress(){/^((25[0-5]|(2[0-4]|1\d|[1-9]|)\d)\.?\b){4}$/.test(this.printerAddress)&&(localStorage.setItem("pinterAddress",this.printerAddress),this.connect())},getPrintStartTime(){var r;return(r=this.printStartTime)==null?void 0:r.toLocaleTimeString()},getPrintJobTime(){if(!this.printJobTime)return null;const r=parseInt(this.printJobTime/60/60),e=parseInt(this.printJobTime/60%60),c=parseInt(this.printJobTime%60);return`${String(r).padStart(2,"0")}:${String(e).padStart(2,"0")}:${String(c).padStart(2,"0")}`},getPrintLeftTime(){if(!this.printLeftTime)return null;const r=parseInt(this.printLeftTime/60/60),e=parseInt(this.printLeftTime/60%60),c=parseInt(this.printLeftTime%60);return`${String(r).padStart(2,"0")}:${String(e).padStart(2,"0")}:${String(c).padStart(2,"0")}`}}},o=r=>(x("data-v-9d292ad8"),r=r(),w(),r),I=o(()=>t("figcaption",null,"Câmera não conectada",-1)),P=["src"],C=["src"],z=o(()=>t("span",null,null,-1)),J={key:0},U={key:1},k=o(()=>t("span",null,"Início da impressão:",-1)),F=o(()=>t("span",null,"Tempo de impressão:",-1)),V=o(()=>t("span",null,"Tempo restante:",-1)),M=o(()=>t("span",null,"Temperatura do bico:",-1)),N={key:0},B=o(()=>t("span",null,"Temperatura da mesa:",-1)),K={key:0},D={key:0},R=o(()=>t("span",null,"Temperatura da câmara:",-1));function E(r,e,c,O,n,d){const f=u("v-card-title"),b=u("v-text-field"),h=u("v-card-text"),_=u("v-card"),S=u("v-divider");return p(),a("main",null,[s(_,null,{default:i(()=>[s(f,null,{default:i(()=>[g(" Conexão ")]),_:1}),s(h,null,{default:i(()=>[s(b,{modelValue:n.printerAddress,"onUpdate:modelValue":e[0]||(e[0]=T=>n.printerAddress=T),rules:n.addressRules,loading:n.loading,label:"IP da impressora","append-inner-icon":"search",placeholder:"255.255.255.255","onClick:appendInner":e[1]||(e[1]=T=>d.saveAddress()),onKeyup:e[2]||(e[2]=L(T=>d.saveAddress(),["enter"]))},null,8,["modelValue","rules","loading"])]),_:1})]),_:1}),s(_,null,{default:i(()=>[s(f,null,{default:i(()=>[g(" Camera ")]),_:1}),s(h,null,{default:i(()=>[t("figure",null,[I,t("img",{src:n.videoUrl||"/img/empty.webp",onerror:"this.src='/img/empty.webp'"},null,8,P)])]),_:1})]),_:1}),s(_,null,{default:i(()=>[s(f,null,{default:i(()=>[g(" Impressão ")]),_:1}),s(h,null,{default:i(()=>[t("article",{style:v({"--progress":`${n.printProgress}%`})},[t("img",{src:n.imgUrl??"/img/bed.webp",onerror:"this.src='/img/bed.webp'"},null,8,C),z,t("footer",null,[n.printProgress?(p(),a("span",J,l(n.printProgress)+"%",1)):m("",!0),n.currentLayer&&n.totalLayer?(p(),a("span",U,"Camada "+l(`${n.currentLayer} / ${n.totalLayer}`),1)):m("",!0)])],4),t("p",null,[k,t("span",null,l(d.getPrintStartTime()),1)]),s(S),t("p",null,[F,t("span",null,l(d.getPrintJobTime()),1)]),t("p",null,[V,t("span",null,l(d.getPrintLeftTime()),1)])]),_:1})]),_:1}),s(_,null,{default:i(()=>[s(f,null,{default:i(()=>[g(" Impressora ")]),_:1}),s(h,null,{default:i(()=>[t("p",null,[M,n.nozzleTemp?(p(),a("span",N,l(n.nozzleTemp)+" °C",1)):m("",!0)]),t("p",null,[B,n.bedTemp?(p(),a("span",K,l(n.bedTemp)+" °C",1)):m("",!0)]),n.boxTemp?(p(),a("p",D,[R,t("span",null,l(n.boxTemp)+" °C",1)])):m("",!0)]),_:1})]),_:1})])}const j=y(A,[["render",E],["__scopeId","data-v-9d292ad8"]]);export{j as default};
